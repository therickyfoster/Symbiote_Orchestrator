<!DOCTYPE html>
<html lang="en" data-theme="nebula">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <title>SymbioteOne-Orchestrator | Production Platform</title>

  <!-- SEO & Social -->
  <meta name="description" content="SymbioteOne-Orchestrator: Production-grade AI-human orchestration platform for planetary restoration and zero-harm missions."/>
  <meta name="keywords" content="SymbioteOne, AI orchestration, planetary restoration, zero-harm, collaboration platform"/>
  <meta name="author" content="Foster + Navi"/>
  <link rel="canonical" href="https://planetaryrestorationarchive.com/"/>
  
  <!-- Open Graph -->
  <meta property="og:title" content="SymbioteOne-Orchestrator Production Platform"/>
  <meta property="og:description" content="Collaborate on planetary restoration missions with AI-powered orchestration"/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://planetaryrestorationarchive.com/"/>
  <meta property="og:image" content="https://planetaryrestorationarchive.com/og-image.png"/>

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' fill='black'/><circle cx='32' cy='32' r='18' fill='%23fff'/><text x='32' y='38' text-anchor='middle' font-size='20' font-family='monospace'>S1</text></svg>"/>

  <!-- 
    ===========================================
    API CONFIGURATION
    ===========================================
    
    BACKEND REQUIREMENTS:
    This frontend expects a REST API with the following endpoints.
    All endpoints should accept/return JSON and use JWT authentication.
    
    BASE_URL: https://api.planetaryrestorationarchive.com/v1
    
    AUTHENTICATION ENDPOINTS:
    POST /auth/register - Register new user
      Body: { email, password, name }
      Returns: { user, token }
    
    POST /auth/login - Login user
      Body: { email, password }
      Returns: { user, token }
    
    POST /auth/logout - Logout user (invalidate token)
      Headers: Authorization: Bearer <token>
    
    GET /auth/me - Get current user
      Headers: Authorization: Bearer <token>
      Returns: { user }
    
    MISSION ENDPOINTS:
    GET /missions - List all missions (with pagination)
      Query: ?page=1&limit=20&domain=fire&status=active
      Returns: { missions: [], total, page, pages }
    
    POST /missions - Create mission
      Body: { title, domain, priority, description }
      Returns: { mission }
    
    GET /missions/:id - Get mission details
      Returns: { mission }
    
    PUT /missions/:id - Update mission
      Body: { status, description, etc }
      Returns: { mission }
    
    DELETE /missions/:id - Delete mission
      Returns: { success }
    
    POST /missions/:id/simulate - Simulate mission
      Returns: { simulation }
    
    AGENT ENDPOINTS:
    GET /agents - List all agents
      Returns: { agents: [] }
    
    POST /agents - Create agent
      Body: { name, role, tools, goal, backstory }
      Returns: { agent }
    
    DELETE /agents/:name - Delete agent
      Returns: { success }
    
    LEDGER ENDPOINTS:
    GET /ledger - Get transparency ledger entries
      Query: ?page=1&limit=50&type=mission:create
      Returns: { entries: [], total }
    
    POST /ledger - Add ledger entry (internal use)
      Body: { type, data }
      Returns: { entry }
    
    CHAT ENDPOINTS:
    POST /chat - Send message to AI
      Body: { message, context, provider }
      Returns: { response, usage }
    
    GET /chat/history - Get chat history
      Query: ?limit=50
      Returns: { messages: [] }
    
    GRAPH ENDPOINTS:
    GET /graphs - List saved graphs
      Returns: { graphs: [] }
    
    POST /graphs - Save graph
      Body: { name, nodes, edges }
      Returns: { graph }
    
    GET /graphs/:id - Get graph
      Returns: { graph }
    
    DELETE /graphs/:id - Delete graph
      Returns: { success }
    
    DAO ENDPOINTS:
    POST /dao/manifest - Generate DAO manifest
      Returns: { manifest }
    
    GET /dao/proposals - List DAO proposals
      Returns: { proposals: [] }
    
    POST /dao/proposals - Create proposal
      Body: { title, description, missionId }
      Returns: { proposal }
    
    POST /dao/proposals/:id/vote - Vote on proposal
      Body: { vote: 'yes'|'no'|'abstain' }
      Returns: { success }
    
    ANALYTICS ENDPOINTS:
    GET /analytics/stats - Get global statistics
      Returns: { users, missions, agents, etc }
    
    GET /analytics/user - Get user analytics
      Returns: { sessions, xp, achievements }
    
    REAL-TIME WEBSOCKET:
    Connect to: wss://api.planetaryrestorationarchive.com/ws
    
    Events to listen for:
    - mission:created
    - mission:updated
    - ledger:entry
    - user:online
    - chat:message (for team chat)
    
    Events to send:
    - subscribe:missions
    - subscribe:ledger
    - ping (keep-alive)
    
    DATABASE SCHEMA RECOMMENDATIONS:
    
    Users Table:
    - id (UUID, primary key)
    - email (unique, indexed)
    - password_hash
    - name
    - avatar_url
    - role (user, admin, moderator)
    - xp (integer)
    - level (integer)
    - achievements (JSON array)
    - created_at
    - updated_at
    - last_seen
    
    Missions Table:
    - id (UUID, primary key)
    - user_id (foreign key to users)
    - title
    - domain
    - priority
    - description (text)
    - status
    - created_at
    - updated_at
    - collaborators (JSON array of user IDs)
    
    Agents Table:
    - id (UUID, primary key)
    - user_id (foreign key to users)
    - name (unique per user)
    - role
    - tools (JSON array)
    - goal (text)
    - backstory (text)
    - policy (JSON)
    - created_at
    
    Ledger Table:
    - id (UUID, primary key)
    - user_id (foreign key to users)
    - mission_id (optional foreign key)
    - type
    - data (JSON)
    - hash
    - timestamp
    - created_at
    
    Graphs Table:
    - id (UUID, primary key)
    - user_id (foreign key to users)
    - name
    - nodes (JSON)
    - edges (JSON)
    - created_at
    - updated_at
    
    ChatMessages Table:
    - id (UUID, primary key)
    - user_id (foreign key to users)
    - mission_id (optional foreign key)
    - role (user, assistant, system)
    - content (text)
    - provider
    - tokens_used
    - created_at
    
    DAOProposals Table:
    - id (UUID, primary key)
    - user_id (foreign key to users)
    - mission_id (optional foreign key)
    - title
    - description (text)
    - status (pending, active, approved, rejected)
    - votes_yes
    - votes_no
    - votes_abstain
    - created_at
    - voting_deadline
    
    DAOVotes Table:
    - id (UUID, primary key)
    - proposal_id (foreign key)
    - user_id (foreign key)
    - vote (yes, no, abstain)
    - created_at
    
    SECURITY RECOMMENDATIONS:
    - Use HTTPS everywhere
    - Implement rate limiting (100 requests/minute per user)
    - Validate all inputs server-side
    - Use prepared statements to prevent SQL injection
    - Hash passwords with bcrypt (cost factor 12+)
    - Rotate JWT secrets regularly
    - Implement CORS properly
    - Add request size limits
    - Log all authentication attempts
    - Implement 2FA for admin accounts
    - Use environment variables for secrets
    - Implement CSP headers
    - Add CSRF protection
  -->

  <style>
    /* ================================= */
    /* BASE THEME SYSTEM */
    /* ================================= */
    :root {
      --bg: #07090f;
      --fg: #e8f0ff;
      --muted: #9bb0c6;
      --accent: #6cf0ff;
      --accent-2: #a0ffb3;
      --warn: #ffd166;
      --danger: #ff6b6b;
      --card: #0b1020ee;
      --glass: #0b102099;
      --grid: rgba(255,255,255,0.06);
      --good: #55efc4;
      --shadow: rgba(0,0,0,0.4);
    }

    /* Dark themes */
    [data-theme="space"] {
      --bg: #0a0e1a;
      --fg: #e0e6ff;
      --accent: #00d9ff;
      --accent-2: #7b2cbf;
      --card: #0f1628ee;
    }

    [data-theme="cyberpunk"] {
      --bg: #0d0221;
      --fg: #00ff9f;
      --muted: #bd00ff;
      --accent: #ff006e;
      --accent-2: #ffbe0b;
      --card: #1a0b2eee;
    }

    /* Light themes */
    [data-theme="anime"] {
      --bg: #fef6fb;
      --fg: #2d1b2e;
      --muted: #8b6f8c;
      --accent: #ff6b9d;
      --accent-2: #4ecdc4;
      --card: #fff3fcee;
      --shadow: rgba(0,0,0,0.15);
    }

    [data-theme="forest"] {
      --bg: #0f1e0f;
      --fg: #d4f1d4;
      --accent: #4caf50;
      --accent-2: #81c784;
      --card: #1a2e1aee;
    }

    /* ================================= */
    /* GLOBAL STYLES */
    /* ================================= */
    * { box-sizing: border-box; margin: 0; padding: 0; }

    html, body {
      height: 100%;
      background: var(--bg);
      color: var(--fg);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
      overflow-x: hidden;
      transition: background 0.3s ease, color 0.3s ease;
    }

    a {
      color: var(--accent);
      text-decoration: none;
      transition: color 0.2s;
    }

    a:hover {
      color: var(--accent-2);
      text-decoration: underline;
    }

    /* ================================= */
    /* LAYOUT */
    /* ================================= */
    .app-container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      position: relative;
    }

    /* Starfield background */
    #starfield {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }

    /* Main content wrapper */
    .content-wrapper {
      position: relative;
      z-index: 1;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    /* ================================= */
    /* HEADER & NAVIGATION */
    /* ================================= */
    header {
      background: linear-gradient(180deg, rgba(7,9,15,0.95), rgba(7,9,15,0.85));
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--grid);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1.5rem;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .logo {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: radial-gradient(circle, #9df 0%, #48f 30%, #05f 70%, #002 100%);
      box-shadow: 0 0 24px rgba(10,175,255,0.6);
      animation: pulse 3s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 24px rgba(10,175,255,0.6); }
      50% { box-shadow: 0 0 40px rgba(10,175,255,0.9); }
    }

    .brand-text h1 {
      font-size: 1.25rem;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .brand-text .tagline {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .user-avatar:hover {
      transform: scale(1.1);
    }

    nav {
      background: rgba(0,0,0,0.2);
      border-bottom: 1px solid var(--grid);
    }

    .nav-content {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0.75rem 1.5rem;
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      align-items: center;
    }

    .nav-btn {
      background: transparent;
      border: 1px solid transparent;
      color: var(--fg);
      padding: 0.5rem 1rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .nav-btn:hover {
      background: rgba(255,255,255,0.05);
      border-color: var(--grid);
    }

    .nav-btn.active {
      background: rgba(108, 240, 255, 0.1);
      border-color: var(--accent);
      color: var(--accent);
    }

    /* ================================= */
    /* MAIN CONTENT AREA */
    /* ================================= */
    main {
      flex: 1;
      max-width: 1400px;
      width: 100%;
      margin: 0 auto;
      padding: 2rem 1.5rem;
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 1.5rem;
      align-items: start;
    }

    .main-content {
      min-width: 0;
    }

    .sidebar {
      position: sticky;
      top: 140px;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    /* ================================= */
    /* CARDS & PANELS */
    /* ================================= */
    .card {
      background: var(--card);
      border: 1px solid var(--grid);
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: 0 8px 32px var(--shadow);
      backdrop-filter: blur(12px);
      transition: all 0.3s ease;
    }

    .card:hover {
      box-shadow: 0 12px 48px var(--shadow);
      transform: translateY(-2px);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--grid);
    }

    .card-title {
      font-size: 1.15rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .card-actions {
      display: flex;
      gap: 0.5rem;
    }

    /* ================================= */
    /* BUTTONS */
    /* ================================= */
    .btn {
      background: linear-gradient(135deg, #0c1326 0%, #0a0f1f 100%);
      border: 1px solid var(--grid);
      color: var(--fg);
      padding: 0.65rem 1rem;
      border-radius: 10px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-family: inherit;
    }

    .btn:hover {
      border-color: var(--accent);
      background: linear-gradient(135deg, #0e1530 0%, #0c1226 100%);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(108, 240, 255, 0.2);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
      border-color: var(--accent);
      color: #000;
      font-weight: 600;
    }

    .btn-primary:hover {
      box-shadow: 0 4px 16px rgba(108, 240, 255, 0.4);
    }

    .btn-danger {
      background: linear-gradient(135deg, var(--danger) 0%, #ff5252 100%);
      border-color: var(--danger);
      color: #fff;
    }

    .btn-small {
      padding: 0.4rem 0.7rem;
      font-size: 0.85rem;
    }

    /* ================================= */
    /* FORMS */
    /* ================================= */
    .form-group {
      margin-bottom: 1.25rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      font-size: 0.9rem;
      color: var(--muted);
    }

    input, textarea, select {
      width: 100%;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--grid);
      border-radius: 10px;
      padding: 0.75rem 1rem;
      color: var(--fg);
      font-size: 0.95rem;
      font-family: inherit;
      transition: all 0.2s;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      background: rgba(255,255,255,0.08);
      box-shadow: 0 0 0 3px rgba(108, 240, 255, 0.1);
    }

    textarea {
      resize: vertical;
      min-height: 100px;
      line-height: 1.5;
    }

    /* ================================= */
    /* AUTHENTICATION SCREENS */
    /* ================================= */
    .auth-screen {
      position: fixed;
      inset: 0;
      z-index: 200;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, rgba(7,9,15,0.95) 0%, rgba(11,16,32,0.95) 100%);
      backdrop-filter: blur(8px);
    }

    .auth-card {
      width: 90%;
      max-width: 420px;
      background: var(--card);
      border: 1px solid var(--grid);
      border-radius: 20px;
      padding: 2.5rem;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }

    .auth-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .auth-logo {
      width: 60px;
      height: 60px;
      margin: 0 auto 1rem;
      border-radius: 16px;
      background: radial-gradient(circle, #9df 0%, #48f 30%, #05f 70%, #002 100%);
      box-shadow: 0 0 32px rgba(10,175,255,0.6);
    }

    .auth-title {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .auth-subtitle {
      color: var(--muted);
      font-size: 0.95rem;
    }

    .auth-toggle {
      text-align: center;
      margin-top: 1.5rem;
      font-size: 0.9rem;
    }

    .auth-toggle a {
      color: var(--accent);
      font-weight: 600;
    }

    .error-message {
      background: rgba(255, 107, 107, 0.1);
      border: 1px solid var(--danger);
      border-radius: 10px;
      padding: 0.75rem 1rem;
      margin-bottom: 1rem;
      color: var(--danger);
      font-size: 0.9rem;
    }

    .success-message {
      background: rgba(85, 239, 196, 0.1);
      border: 1px solid var(--good);
      border-radius: 10px;
      padding: 0.75rem 1rem;
      margin-bottom: 1rem;
      color: var(--good);
      font-size: 0.9rem;
    }

    /* ================================= */
    /* LOADING STATES */
    /* ================================= */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid var(--grid);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .skeleton {
      background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%);
      background-size: 200% 100%;
      animation: shimmer 1.5s ease-in-out infinite;
      border-radius: 8px;
      height: 20px;
    }

    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    /* ================================= */
    /* STATUS INDICATORS */
    /* ================================= */
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 0.5rem;
    }

    .status-online { background: var(--good); box-shadow: 0 0 8px var(--good); }
    .status-offline { background: var(--muted); }
    .status-error { background: var(--danger); box-shadow: 0 0 8px var(--danger); }

    /* ================================= */
    /* LISTS & GRIDS */
    /* ================================= */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1rem;
    }

    .list-item {
      background: rgba(255,255,255,0.03);
      border: 1px solid var(--grid);
      border-radius: 12px;
      padding: 1rem;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .list-item:hover {
      background: rgba(255,255,255,0.06);
      border-color: var(--accent);
      transform: translateX(4px);
    }

    .list-item-content {
      flex: 1;
      min-width: 0;
    }

    .list-item-title {
      font-weight: 600;
      margin-bottom: 0.25rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .list-item-meta {
      font-size: 0.85rem;
      color: var(--muted);
    }

    /* ================================= */
    /* CHAT INTERFACE */
    /* ================================= */
    .chat-container {
      display: flex;
      flex-direction: column;
      height: 500px;
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      overflow: hidden;
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .chat-message {
      display: flex;
      gap: 0.75rem;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .chat-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.85rem;
    }

    .chat-message.user .chat-avatar {
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
      color: #000;
    }

    .chat-message.assistant .chat-avatar {
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: #fff;
    }

    .chat-bubble {
      flex: 1;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--grid);
      border-radius: 12px;
      padding: 0.75rem 1rem;
      line-height: 1.6;
    }

    .chat-message.user .chat-bubble {
      background: rgba(108, 240, 255, 0.1);
      border-color: rgba(108, 240, 255, 0.3);
    }

    .chat-input-area {
      border-top: 1px solid var(--grid);
      padding: 1rem;
      background: rgba(0,0,0,0.2);
    }

    .chat-input-wrapper {
      display: flex;
      gap: 0.75rem;
    }

    .chat-input-wrapper textarea {
      resize: none;
      min-height: 60px;
      max-height: 150px;
    }

    /* ================================= */
    /* STATS & METRICS */
    /* ================================= */
    .stat-card {
      background: rgba(255,255,255,0.03);
      border: 1px solid var(--grid);
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 0.25rem;
    }

    .stat-label {
      font-size: 0.85rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* ================================= */
    /* TOOLTIPS */
    /* ================================= */
    [data-tooltip] {
      position: relative;
      cursor: help;
    }

    [data-tooltip]::before {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(-8px);
      padding: 0.5rem 0.75rem;
      background: rgba(0,0,0,0.95);
      color: white;
      border: 1px solid var(--accent);
      border-radius: 8px;
      font-size: 0.8rem;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s, transform 0.3s;
      z-index: 1000;
    }

    [data-tooltip]:hover::before {
      opacity: 1;
      transform: translateX(-50%) translateY(-4px);
    }

    /* ================================= */
    /* BADGES */
    /* ================================= */
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    .badge-success {
      background: rgba(85, 239, 196, 0.2);
      color: var(--good);
      border: 1px solid var(--good);
    }

    .badge-warning {
      background: rgba(255, 209, 102, 0.2);
      color: var(--warn);
      border: 1px solid var(--warn);
    }

    .badge-danger {
      background: rgba(255, 107, 107, 0.2);
      color: var(--danger);
      border: 1px solid var(--danger);
    }

    .badge-info {
      background: rgba(108, 240, 255, 0.2);
      color: var(--accent);
      border: 1px solid var(--accent);
    }

    /* ================================= */
    /* MODALS */
    /* ================================= */
    .modal-overlay {
      position: fixed;
      inset: 0;
      z-index: 150;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: var(--card);
      border: 1px solid var(--grid);
      border-radius: 20px;
      padding: 2rem;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }

    /* ================================= */
    /* NOTIFICATIONS / TOASTS */
    /* ================================= */
    .toast-container {
      position: fixed;
      top: 5rem;
      right: 1rem;
      z-index: 160;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      pointer-events: none;
    }

    .toast {
      background: var(--card);
      border: 1px solid var(--grid);
      border-radius: 12px;
      padding: 1rem 1.25rem;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      backdrop-filter: blur(12px);
      pointer-events: all;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      min-width: 300px;
      animation: slideInRight 0.3s ease;
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(100%);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .toast-icon {
      font-size: 1.5rem;
    }

    .toast-content {
      flex: 1;
    }

    .toast-close {
      cursor: pointer;
      opacity: 0.6;
      transition: opacity 0.2s;
    }

    .toast-close:hover {
      opacity: 1;
    }

    /* ================================= */
    /* FOOTER */
    /* ================================= */
    footer {
      background: rgba(0,0,0,0.3);
      border-top: 1px solid var(--grid);
      padding: 2rem 1.5rem;
      text-align: center;
      color: var(--muted);
    }

    .footer-content {
      max-width: 1400px;
      margin: 0 auto;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }

    /* ================================= */
    /* RESPONSIVE */
    /* ================================= */
    @media (max-width: 1024px) {
      main {
        grid-template-columns: 1fr;
      }

      .sidebar {
        position: static;
      }

      .header-content {
        flex-direction: column;
        align-items: stretch;
      }

      .nav-content {
        overflow-x: auto;
        flex-wrap: nowrap;
      }
    }

    @media (max-width: 640px) {
      .header-content {
        padding: 1rem;
      }

      main {
        padding: 1rem;
      }

      .auth-card {
        padding: 1.5rem;
      }

      .brand-text h1 {
        font-size: 1.1rem;
      }

      .btn {
        padding: 0.5rem 0.75rem;
        font-size: 0.85rem;
      }
    }

    /* ================================= */
    /* UTILITY CLASSES */
    /* ================================= */
    .hidden { display: none !important; }
    .text-center { text-align: center; }
    .text-muted { color: var(--muted); }
    .text-small { font-size: 0.85rem; }
    .mt-1 { margin-top: 0.5rem; }
    .mt-2 { margin-top: 1rem; }
    .mb-1 { margin-bottom: 0.5rem; }
    .mb-2 { margin-bottom: 1rem; }
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .gap-1 { gap: 0.5rem; }
    .gap-2 { gap: 1rem; }
    .items-center { align-items: center; }
    .justify-between { justify-content: space-between; }
  </style>
</head>

<body>
  <!-- Starfield Background -->
  <canvas id="starfield"></canvas>

  <!-- Toast Notifications -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Application Container -->
  <div class="app-container">
    
    <!-- Authentication Screen (shown when not logged in) -->
    <div class="auth-screen" id="authScreen">
      <div class="auth-card">
        <div class="auth-header">
          <div class="auth-logo"></div>
          <h2 class="auth-title">SymbioteOne</h2>
          <p class="auth-subtitle">AI-Human Orchestration for Planetary Restoration</p>
        </div>

        <!-- Login Form -->
        <form id="loginForm" class="hidden">
          <div id="loginError" class="error-message hidden"></div>
          
          <div class="form-group">
            <label for="loginEmail">Email</label>
            <input type="email" id="loginEmail" placeholder="your@email.com" required autocomplete="email" />
          </div>

          <div class="form-group">
            <label for="loginPassword">Password</label>
            <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password" />
          </div>

          <button type="submit" class="btn btn-primary" style="width: 100%;">
            <span id="loginBtnText">Sign In</span>
            <span id="loginSpinner" class="loading-spinner hidden"></span>
          </button>

          <div class="auth-toggle">
            Don't have an account? <a href="#" id="showRegister">Create one</a>
          </div>
        </form>

        <!-- Register Form -->
        <form id="registerForm">
          <div id="registerError" class="error-message hidden"></div>
          
          <div class="form-group">
            <label for="registerName">Name</label>
            <input type="text" id="registerName" placeholder="Your name" required autocomplete="name" />
          </div>

          <div class="form-group">
            <label for="registerEmail">Email</label>
            <input type="email" id="registerEmail" placeholder="your@email.com" required autocomplete="email" />
          </div>

          <div class="form-group">
            <label for="registerPassword">Password</label>
            <input type="password" id="registerPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="new-password" minlength="8" />
          </div>

          <div class="form-group">
            <label for="registerPasswordConfirm">Confirm Password</label>
            <input type="password" id="registerPasswordConfirm" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="new-password" minlength="8" />
          </div>

          <button type="submit" class="btn btn-primary" style="width: 100%;">
            <span id="registerBtnText">Create Account</span>
            <span id="registerSpinner" class="loading-spinner hidden"></span>
          </button>

          <div class="auth-toggle">
            Already have an account? <a href="#" id="showLogin">Sign in</a>
          </div>
        </form>
      </div>
    </div>

    <!-- Main Application (shown when logged in) -->
    <div class="content-wrapper hidden" id="mainApp">
      
      <!-- Header -->
      <header>
        <div class="header-content">
          <div class="brand">
            <div class="logo"></div>
            <div class="brand-text">
              <h1>SymbioteOne-Orchestrator</h1>
              <div class="tagline">Production Platform</div>
            </div>
          </div>

          <div class="user-menu">
            <span class="badge badge-info">
              <span class="status-dot status-online"></span>
              <span id="onlineUsers">1</span> online
            </span>
            <div class="user-avatar" id="userAvatar" data-tooltip="User menu">U</div>
          </div>
        </div>

        <nav>
          <div class="nav-content">
            <button class="nav-btn active" data-tab="dashboard">üìä Dashboard</button>
            <button class="nav-btn" data-tab="missions">üéØ Missions</button>
            <button class="nav-btn" data-tab="agents">ü§ñ Agents</button>
            <button class="nav-btn" data-tab="chat">üí¨ AI Chat</button>
            <button class="nav-btn" data-tab="graph">üîÅ LangGraph</button>
            <button class="nav-btn" data-tab="dao">‚ôªÔ∏è DAO</button>
            <button class="nav-btn" data-tab="team">üë• Team</button>
            <button class="nav-btn" data-tab="settings">‚öôÔ∏è Settings</button>
          </div>
        </nav>
      </header>

      <!-- Main Content -->
      <main>
        <div class="main-content">
          
          <!-- Dashboard View -->
          <div class="view-content" id="view-dashboard">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">üåê Welcome Back</h2>
              </div>
              
              <p class="text-muted mb-2">
                You're connected to the SymbioteOne network. All your missions, agents, and decisions are synchronized 
                across devices and accessible to your collaborators.
              </p>

              <div class="grid mt-2">
                <div class="stat-card">
                  <div class="stat-value" id="statMissions">0</div>
                  <div class="stat-label">Active Missions</div>
                </div>
                <div class="stat-card">
                  <div class="stat-value" id="statAgents">0</div>
                  <div class="stat-label">Configured Agents</div>
                </div>
                <div class="stat-card">
                  <div class="stat-value" id="statXP">0</div>
                  <div class="stat-label">Total XP</div>
                </div>
              </div>
            </div>

            <div class="card mt-2">
              <div class="card-header">
                <h3 class="card-title">üïê Recent Activity</h3>
              </div>
              <div id="recentActivity">
                <div class="skeleton mb-1"></div>
                <div class="skeleton mb-1"></div>
                <div class="skeleton"></div>
              </div>
            </div>

            <div class="card mt-2">
              <div class="card-header">
                <h3 class="card-title">üöÄ Quick Start Guide</h3>
              </div>
              <ol style="line-height: 2; color: var(--muted);">
                <li><strong>Create your first mission</strong> - Define a planetary restoration goal</li>
                <li><strong>Configure agents</strong> - Set up AI agents with specific roles and tools</li>
                <li><strong>Design workflows</strong> - Build LangGraph state machines for agent coordination</li>
                <li><strong>Collaborate</strong> - Invite team members to join your missions</li>
                <li><strong>Execute & Monitor</strong> - Track progress through the transparency ledger</li>
              </ol>
            </div>
          </div>

          <!-- Missions View -->
          <div class="view-content hidden" id="view-missions">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">üéØ Mission Control</h2>
                <button class="btn btn-primary btn-small" id="createMissionBtn">‚ûï New Mission</button>
              </div>

              <div class="form-group">
                <input type="text" id="missionSearch" placeholder="üîç Search missions by title, domain, or status..." />
              </div>

              <div id="missionsList">
                <!-- Missions will be dynamically loaded here -->
              </div>
            </div>
          </div>

          <!-- Agents View -->
          <div class="view-content hidden" id="view-agents">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">ü§ñ Agent Configuration</h2>
                <button class="btn btn-primary btn-small" id="createAgentBtn">‚ûï New Agent</button>
              </div>

              <div id="agentsList">
                <!-- Agents will be dynamically loaded here -->
              </div>
            </div>
          </div>

          <!-- Chat View -->
          <div class="view-content hidden" id="view-chat">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">üí¨ AI Orchestration Chat</h2>
                <div class="card-actions">
                  <button class="btn btn-small" id="clearChatBtn">üóëÔ∏è Clear</button>
                  <button class="btn btn-small" id="exportChatBtn">üíæ Export</button>
                </div>
              </div>

              <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                  <div class="chat-message assistant">
                    <div class="chat-avatar">AI</div>
                    <div class="chat-bubble">
                      Welcome! I'm your AI orchestration assistant. I can help you plan missions, coordinate agents, 
                      and generate zero-harm strategies. What would you like to work on?
                    </div>
                  </div>
                </div>

                <div class="chat-input-area">
                  <div class="chat-input-wrapper">
                    <textarea id="chatInput" placeholder="Ask about mission planning, agent coordination, or strategic recommendations..."></textarea>
                    <button class="btn btn-primary" id="sendChatBtn">üì§ Send</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Other views would follow similar patterns -->
          <div class="view-content hidden" id="view-graph">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">üîÅ LangGraph Designer</h2>
              </div>
              <p class="text-muted">Visual workflow designer coming soon. Design stateful agent coordination flows.</p>
            </div>
          </div>

          <div class="view-content hidden" id="view-dao">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">‚ôªÔ∏è DAO Governance</h2>
              </div>
              <p class="text-muted">Decentralized governance features coming soon. Create proposals, vote on missions, and verify impact.</p>
            </div>
          </div>

          <div class="view-content hidden" id="view-team">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">üë• Team Collaboration</h2>
              </div>
              <p class="text-muted">Invite collaborators, manage permissions, and coordinate on shared missions.</p>
            </div>
          </div>

          <div class="view-content hidden" id="view-settings">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">‚öôÔ∏è Settings</h2>
              </div>

              <div class="form-group">
                <label>Theme</label>
                <select id="themeSelect">
                  <option value="nebula">Nebula (Default)</option>
                  <option value="space">Space</option>
                  <option value="cyberpunk">Cyberpunk</option>
                  <option value="forest">Forest</option>
                  <option value="anime">Anime</option>
                </select>
              </div>

              <div class="form-group">
                <label>AI Provider</label>
                <select id="aiProviderSelect">
                  <option value="openai">OpenAI GPT-4</option>
                  <option value="anthropic">Anthropic Claude</option>
                  <option value="google">Google Gemini</option>
                  <option value="ollama">Ollama (Local)</option>
                </select>
              </div>

              <button class="btn btn-danger mt-2" id="logoutBtn">üö™ Sign Out</button>
            </div>
          </div>

        </div>

        <!-- Sidebar -->
        <aside class="sidebar">
          <div class="card">
            <h3 class="card-title mb-1">üéÆ Your Progress</h3>
            <div class="stat-card">
              <div class="stat-value">Level <span id="userLevel">1</span></div>
              <div class="stat-label"><span id="userXP">0</span> / <span id="userXPNeeded">100</span> XP</div>
            </div>
            <div style="margin-top: 1rem;">
              <div style="background: rgba(255,255,255,0.1); height: 8px; border-radius: 4px; overflow: hidden;">
                <div id="xpBar" style="background: linear-gradient(90deg, var(--accent), var(--accent-2)); height: 100%; width: 0%; transition: width 0.5s;"></div>
              </div>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title mb-1">üì° System Status</h3>
            <div class="list-item-meta flex items-center gap-1">
              <span class="status-dot status-online"></span>
              <span>API Connected</span>
            </div>
            <div class="list-item-meta flex items-center gap-1 mt-1">
              <span class="status-dot status-online"></span>
              <span>WebSocket Active</span>
            </div>
            <div class="list-item-meta flex items-center gap-1 mt-1">
              <span class="status-dot status-online"></span>
              <span>AI Provider Ready</span>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title mb-1">üèÜ Recent Achievements</h3>
            <p class="text-small text-muted">Complete missions to unlock achievements</p>
          </div>
        </aside>
      </main>

      <!-- Footer -->
      <footer>
        <div class="footer-content">
          <div class="footer-links">
            <a href="https://planetaryrestorationarchive.com/docs" target="_blank">Documentation</a>
            <a href="https://github.com/TheRickyFoster" target="_blank">GitHub</a>
            <a href="https://planetaryrestorationarchive.com/legal" target="_blank">License</a>
            <a href="https://planetaryrestorationarchive.com/privacy" target="_blank">Privacy</a>
            <a href="https://planetaryrestorationarchive.com/support" target="_blank">Support</a>
          </div>
          <p class="text-small">
            ¬© 2025 SymbioteOne-Orchestrator ‚Ä¢ Created by Foster + Navi<br>
            Zero-Harm ‚Ä¢ DAO-Ready ‚Ä¢ Production Platform
          </p>
          <p class="text-small mt-1">
            <strong>Non-Weaponization Clause:</strong> This platform is intended solely for planetary restoration, 
            conflict prevention, and humanitarian purposes.
          </p>
        </div>
      </footer>
    </div>
  </div>

  <!-- Application JavaScript -->
  <script>
  (async () => {
    'use strict';

    // =================================
    // CONFIGURATION
    // =================================
    
    /**
     * API Configuration
     * 
     * IMPORTANT: Replace this with your actual API endpoint before deploying.
     * For local development, you might use: http://localhost:3000/api/v1
     * For production: https://api.planetaryrestorationarchive.com/v1
     */
    const API_CONFIG = {
      baseURL: 'https://api.planetaryrestorationarchive.com/v1',
      wsURL: 'wss://api.planetaryrestorationarchive.com/ws',
      timeout: 30000, // 30 seconds
      retryAttempts: 3,
      retryDelay: 1000 // 1 second
    };

    /**
     * Application State
     * 
     * This object holds all the runtime state for the application.
     * In a production environment, this would sync with the backend.
     */
    const STATE = {
      user: null,
      token: null,
      missions: [],
      agents: [],
      chatHistory: [],
      isAuthenticated: false,
      ws: null,
      currentView: 'dashboard'
    };

    // =================================
    // STARFIELD RENDERING
    // =================================
    
    /**
     * Starfield Background
     * 
     * Creates an animated starfield effect using Canvas API.
     * This provides a visually appealing background that doesn't
     * interfere with UI readability.
     */
    const canvas = document.getElementById('starfield');
    const ctx = canvas.getContext('2d');
    let W, H;
    const stars = [];
    const STAR_COUNT = 600;

    function resizeCanvas() {
      W = canvas.width = window.innerWidth;
      H = canvas.height = window.innerHeight;
    }

    function createStar() {
      return {
        x: Math.random() * W,
        y: Math.random() * H,
        z: Math.random() * 2 + 0.1,
        size: Math.random() * 2,
        speed: Math.random() * 0.5 + 0.2
      };
    }

    function initStarfield() {
      for (let i = 0; i < STAR_COUNT; i++) {
        stars.push(createStar());
      }
    }

    function animateStarfield() {
      ctx.fillStyle = getComputedStyle(document.documentElement)
        .getPropertyValue('--bg') || '#07090f';
      ctx.fillRect(0, 0, W, H);

      stars.forEach(star => {
        star.x += star.speed;
        if (star.x > W) star.x = 0;

        const opacity = 0.3 + (star.z / 2) * 0.7;
        ctx.fillStyle = `rgba(255, 255, 255, ${opacity})`;
        ctx.fillRect(star.x, star.y, star.size, star.size);
      });

      requestAnimationFrame(animateStarfield);
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    initStarfield();
    animateStarfield();

    // =================================
    // UTILITY FUNCTIONS
    // =================================
    
    /**
     * Show Toast Notification
     * 
     * Displays a temporary notification to the user.
     * Automatically dismisses after 5 seconds.
     * 
     * @param {string} message - The message to display
     * @param {string} type - success, error, warning, info
     */
    function showToast(message, type = 'info') {
      const container = document.getElementById('toastContainer');
      const toast = document.createElement('div');
      toast.className = 'toast';
      
      const icons = {
        success: '‚úÖ',
        error: '‚ùå',
        warning: '‚ö†Ô∏è',
        info: '‚ÑπÔ∏è'
      };

      toast.innerHTML = `
        <span class="toast-icon">${icons[type] || icons.info}</span>
        <div class="toast-content">${message}</div>
        <span class="toast-close" onclick="this.parentElement.remove()">‚úñ</span>
      `;

      container.appendChild(toast);

      setTimeout(() => {
        toast.style.opacity = '0';
        setTimeout(() => toast.remove(), 300);
      }, 5000);
    }

    /**
     * API Request Handler
     * 
     * Makes authenticated requests to the backend API.
     * Handles errors, retries, and token refresh automatically.
     * 
     * @param {string} endpoint - API endpoint (e.g., '/missions')
     * @param {object} options - Fetch options (method, body, etc.)
     * @returns {Promise} - Response data
     */
    async function apiRequest(endpoint, options = {}) {
      const url = `${API_CONFIG.baseURL}${endpoint}`;
      const headers = {
        'Content-Type': 'application/json',
        ...options.headers
      };

      if (STATE.token) {
        headers['Authorization'] = `Bearer ${STATE.token}`;
      }

      try {
        const response = await fetch(url, {
          ...options,
          headers,
          timeout: API_CONFIG.timeout
        });

        if (response.status === 401) {
          // Token expired, redirect to login
          logout();
          throw new Error('Session expired. Please log in again.');
        }

        if (!response.ok) {
          const error = await response.json().catch(() => ({ message: 'Unknown error' }));
          throw new Error(error.message || `HTTP ${response.status}`);
        }

        return await response.json();
      } catch (error) {
        console.error('API Request Failed:', error);
        throw error;
      }
    }

    /**
     * Save to Local Storage
     * 
     * Persists authentication token to browser storage.
     * This allows users to stay logged in across sessions.
     */
    function saveAuth(token, user) {
      localStorage.setItem('auth_token', token);
      localStorage.setItem('user_data', JSON.stringify(user));
      STATE.token = token;
      STATE.user = user;
      STATE.isAuthenticated = true;
    }

    /**
     * Load from Local Storage
     * 
     * Retrieves saved authentication data on page load.
     */
    function loadAuth() {
      const token = localStorage.getItem('auth_token');
      const userData = localStorage.getItem('user_data');
      
      if (token && userData) {
        STATE.token = token;
        STATE.user = JSON.parse(userData);
        STATE.isAuthenticated = true;
        return true;
      }
      return false;
    }

    /**
     * Clear Authentication
     * 
     * Removes all authentication data and returns to login screen.
     */
    function logout() {
      localStorage.removeItem('auth_token');
      localStorage.removeItem('user_data');
      STATE.token = null;
      STATE.user = null;
      STATE.isAuthenticated = false;
      
      if (STATE.ws) {
        STATE.ws.close();
        STATE.ws = null;
      }

      document.getElementById('authScreen').classList.remove('hidden');
      document.getElementById('mainApp').classList.add('hidden');
    }

    // =================================
    // AUTHENTICATION
    // =================================
    
    /**
     * Register New User
     * 
     * Creates a new account and logs the user in.
     */
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const name = document.getElementById('registerName').value;
      const email = document.getElementById('registerEmail').value;
      const password = document.getElementById('registerPassword').value;
      const passwordConfirm = document.getElementById('registerPasswordConfirm').value;
      const errorEl = document.getElementById('registerError');
      const btnText = document.getElementById('registerBtnText');
      const spinner = document.getElementById('registerSpinner');

      errorEl.classList.add('hidden');

      if (password !== passwordConfirm) {
        errorEl.textContent = 'Passwords do not match';
        errorEl.classList.remove('hidden');
        return;
      }

      if (password.length < 8) {
        errorEl.textContent = 'Password must be at least 8 characters';
        errorEl.classList.remove('hidden');
        return;
      }

      btnText.classList.add('hidden');
      spinner.classList.remove('hidden');

      try {
        const data = await apiRequest('/auth/register', {
          method: 'POST',
          body: JSON.stringify({ name, email, password })
        });

        saveAuth(data.token, data.user);
        showToast('Account created successfully!', 'success');
        initializeApp();
      } catch (error) {
        errorEl.textContent = error.message;
        errorEl.classList.remove('hidden');
      } finally {
        btnText.classList.remove('hidden');
        spinner.classList.add('hidden');
      }
    });

    /**
     * Login Existing User
     * 
     * Authenticates user credentials and starts a session.
     */
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      const errorEl = document.getElementById('loginError');
      const btnText = document.getElementById('loginBtnText');
      const spinner = document.getElementById('loginSpinner');

      errorEl.classList.add('hidden');
      btnText.classList.add('hidden');
      spinner.classList.remove('hidden');

      try {
        const data = await apiRequest('/auth/login', {
          method: 'POST',
          body: JSON.stringify({ email, password })
        });

        saveAuth(data.token, data.user);
        showToast('Welcome back!', 'success');
        initializeApp();
      } catch (error) {
        errorEl.textContent = error.message;
        errorEl.classList.remove('hidden');
      } finally {
        btnText.classList.remove('hidden');
        spinner.classList.add('hidden');
      }
    });

    /**
     * Toggle Between Login and Register
     */
    document.getElementById('showRegister').addEventListener('click', (e) => {
      e.preventDefault();
      document.getElementById('loginForm').classList.add('hidden');
      document.getElementById('registerForm').classList.remove('hidden');
    });

    document.getElementById('showLogin').addEventListener('click', (e) => {
      e.preventDefault();
      document.getElementById('registerForm').classList.add('hidden');
      document.getElementById('loginForm').classList.remove('hidden');
    });

    /**
     * Logout Handler
     */
    document.getElementById('logoutBtn').addEventListener('click', async () => {
      try {
        await apiRequest('/auth/logout', { method: 'POST' });
      } catch (error) {
        console.error('Logout error:', error);
      } finally {
        logout();
        showToast('Logged out successfully', 'info');
      }
    });

    // =================================
    // NAVIGATION
    // =================================
    
    /**
     * Tab Navigation System
     * 
     * Switches between different views in the application.
     */
    function switchView(viewName) {
      // Hide all views
      document.querySelectorAll('.view-content').forEach(view => {
        view.classList.add('hidden');
      });

      // Show selected view
      document.getElementById(`view-${viewName}`).classList.remove('hidden');

      // Update active nav button
      document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.classList.toggle('active', btn.getAttribute('data-tab') === viewName);
      });

      STATE.currentView = viewName;

      // Load data for the view
      loadViewData(viewName);
    }

    document.querySelectorAll('.nav-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        switchView(btn.getAttribute('data-tab'));
      });
    });

    /**
     * Load Data for Current View
     * 
     * Fetches data from the API when switching views.
     */
    async function loadViewData(viewName) {
      try {
        switch (viewName) {
          case 'dashboard':
            await loadDashboard();
            break;
          case 'missions':
            await loadMissions();
            break;
          case 'agents':
            await loadAgents();
            break;
          case 'chat':
            await loadChatHistory();
            break;
        }
      } catch (error) {
        console.error('Error loading view data:', error);
        showToast('Failed to load data', 'error');
      }
    }

    // =================================
    // DATA LOADING FUNCTIONS
    // =================================
    
    /**
     * Load Dashboard Data
     */
    async function loadDashboard() {
      try {
        const stats = await apiRequest('/analytics/stats');
        
        document.getElementById('statMissions').textContent = stats.missions || 0;
        document.getElementById('statAgents').textContent = stats.agents || 0;
        document.getElementById('statXP').textContent = STATE.user?.xp || 0;

        // Load recent activity
        const ledger = await apiRequest('/ledger?limit=5');
        const activityContainer = document.getElementById('recentActivity');
        
        if (ledger.entries && ledger.entries.length > 0) {
          activityContainer.innerHTML = ledger.entries.map(entry => `
            <div class="list-item">
              <div class="list-item-content">
                <div class="list-item-title">${entry.type}</div>
                <div class="list-item-meta">${new Date(entry.timestamp).toLocaleString()}</div>
              </div>
            </div>
          `).join('');
        } else {
          activityContainer.innerHTML = '<p class="text-muted">No recent activity</p>';
        }
      } catch (error) {
        console.error('Dashboard load error:', error);
      }
    }

    /**
     * Load Missions Data
     */
    async function loadMissions() {
      try {
        const data = await apiRequest('/missions');
        STATE.missions = data.missions || [];
        renderMissions();
      } catch (error) {
        console.error('Missions load error:', error);
      }
    }

    function renderMissions() {
      const container = document.getElementById('missionsList');
      
      if (STATE.missions.length === 0) {
        container.innerHTML = '<p class="text-muted">No missions yet. Create your first mission to get started!</p>';
        return;
      }

      container.innerHTML = STATE.missions.map(mission => `
        <div class="list-item">
          <div class="list-item-content">
            <div class="list-item-title">${mission.title}</div>
            <div class="list-item-meta">
              <span class="badge badge-${mission.priority === 'high' ? 'danger' : 'info'}">${mission.priority}</span>
              ${mission.domain} ‚Ä¢ ${mission.status}
            </div>
          </div>
          <button class="btn btn-small" onclick="viewMission('${mission.id}')">View</button>
        </div>
      `).join('');
    }

    /**
     * Load Agents Data
     */
    async function loadAgents() {
      try {
        const data = await apiRequest('/agents');
        STATE.agents = data.agents || [];
        renderAgents();
      } catch (error) {
        console.error('Agents load error:', error);
      }
    }

    function renderAgents() {
      const container = document.getElementById('agentsList');
      
      if (STATE.agents.length === 0) {
        container.innerHTML = '<p class="text-muted">No agents configured. Create your first agent to begin orchestration!</p>';
        return;
      }

      container.innerHTML = STATE.agents.map(agent => `
        <div class="list-item">
          <div class="list-item-content">
            <div class="list-item-title">${agent.name}</div>
            <div class="list-item-meta">${agent.role} ‚Ä¢ ${agent.tools.length} tools</div>
          </div>
          <button class="btn btn-small" onclick="editAgent('${agent.id}')">Edit</button>
        </div>
      `).join('');
    }

    /**
     * Load Chat History
     */
    async function loadChatHistory() {
      try {
        const data = await apiRequest('/chat/history?limit=50');
        STATE.chatHistory = data.messages || [];
        renderChatHistory();
      } catch (error) {
        console.error('Chat history load error:', error);
      }
    }

    function renderChatHistory() {
      const container = document.getElementById('chatMessages');
      
      // Keep welcome message and add history
      STATE.chatHistory.forEach(msg => {
        addChatMessage(msg.role, msg.content, false);
      });
    }

    // =================================
    // CHAT FUNCTIONS
    // =================================
    
    /**
     * Add Message to Chat
     */
    function addChatMessage(role, content, animate = true) {
      const container = document.getElementById('chatMessages');
      const message = document.createElement('div');
      message.className = `chat-message ${role}`;
      
      message.innerHTML = `
        <div class="chat-avatar">${role === 'user' ? STATE.user.name[0].toUpperCase() : 'AI'}</div>
        <div class="chat-bubble">${content}</div>
      `;

      container.appendChild(message);
      container.scrollTop = container.scrollHeight;
    }

    /**
     * Send Chat Message
     */
    document.getElementById('sendChatBtn').addEventListener('click', async () => {
      const input = document.getElementById('chatInput');
      const message = input.value.trim();

      if (!message) return;

      addChatMessage('user', message);
      input.value = '';

      try {
        const response = await apiRequest('/chat', {
          method: 'POST',
          body: JSON.stringify({
            message,
            context: STATE.chatHistory.slice(-10),
            provider: document.getElementById('aiProviderSelect').value
          })
        });

        addChatMessage('assistant', response.response);
        STATE.chatHistory.push(
          { role: 'user', content: message },
          { role: 'assistant', content: response.response }
        );
      } catch (error) {
        addChatMessage('system', `Error: ${error.message}`);
        showToast('Failed to send message', 'error');
      }
    });

    // Allow Enter to send
    document.getElementById('chatInput').addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        document.getElementById('sendChatBtn').click();
      }
    });

    // =================================
    // WEBSOCKET CONNECTION
    // =================================
    
    /**
     * Initialize WebSocket Connection
     * 
     * Connects to the backend for real-time updates.
     */
    function initWebSocket() {
      if (!STATE.token) return;

      STATE.ws = new WebSocket(`${API_CONFIG.wsURL}?token=${STATE.token}`);

      STATE.ws.onopen = () => {
        console.log('WebSocket connected');
        STATE.ws.send(JSON.stringify({ type: 'subscribe', channels: ['missions', 'ledger'] }));
      };

      STATE.ws.onmessage = (event) => {
        try {
          const data = JSON.parse(event.data);
          handleWebSocketMessage(data);
        } catch (error) {
          console.error('WebSocket message error:', error);
        }
      };

      STATE.ws.onerror = (error) => {
        console.error('WebSocket error:', error);
      };

      STATE.ws.onclose = () => {
        console.log('WebSocket disconnected');
        // Attempt to reconnect after 5 seconds
        setTimeout(initWebSocket, 5000);
      };
    }

    /**
     * Handle WebSocket Messages
     */
    function handleWebSocketMessage(data) {
      switch (data.type) {
        case 'mission:created':
        case 'mission:updated':
          if (STATE.currentView === 'missions') {
            loadMissions();
          }
          showToast('Mission updated', 'info');
          break;

        case 'ledger:entry':
          if (STATE.currentView === 'dashboard') {
            loadDashboard();
          }
          break;

        case 'user:online':
          document.getElementById('onlineUsers').textContent = data.count;
          break;
      }
    }

    // =================================
    // THEME MANAGEMENT
    // =================================
    
    document.getElementById('themeSelect').addEventListener('change', (e) => {
      document.documentElement.setAttribute('data-theme', e.target.value);
      localStorage.setItem('theme', e.target.value);
    });

    // Load saved theme
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      document.documentElement.setAttribute('data-theme', savedTheme);
      document.getElementById('themeSelect').value = savedTheme;
    }

    // =================================
    // USER PROFILE UPDATE
    // =================================
    
    function updateUserProfile() {
      if (!STATE.user) return;

      const avatar = document.getElementById('userAvatar');
      avatar.textContent = STATE.user.name[0].toUpperCase();
      avatar.setAttribute('data-tooltip', STATE.user.name);

      document.getElementById('userLevel').textContent = STATE.user.level || 1;
      document.getElementById('userXP').textContent = STATE.user.xp || 0;
      document.getElementById('userXPNeeded').textContent = STATE.user.xpNeeded || 100;

      const xpPercent = ((STATE.user.xp || 0) / (STATE.user.xpNeeded || 100)) * 100;
      document.getElementById('xpBar').style.width = `${xpPercent}%`;
    }

    // =================================
    // INITIALIZATION
    // =================================
    
    /**
     * Initialize Application
     * 
     * Called after successful authentication.
     * Loads initial data and sets up real-time connections.
     */
    async function initializeApp() {
      document.getElementById('authScreen').classList.add('hidden');
      document.getElementById('mainApp').classList.remove('hidden');

      updateUserProfile();
      
      // Initialize WebSocket for real-time updates
      initWebSocket();

      // Load initial view data
      loadViewData('dashboard');

      console.log('%cüöÄ SymbioteOne-Orchestrator Initialized', 'font-size: 16px; color: #6cf0ff;');
      console.log('%cConnected as:', 'color: #a0ffb3;', STATE.user.name);
    }

    /**
     * Application Entry Point
     * 
     * Checks if user is already logged in, otherwise shows auth screen.
     */
    async function init() {
      const hasAuth = loadAuth();

      if (hasAuth) {
        try {
          // Verify token is still valid
          const userData = await apiRequest('/auth/me');
          STATE.user = userData.user;
          initializeApp();
        } catch (error) {
          // Token invalid, show login
          logout();
        }
      } else {
        // Show login screen
        document.getElementById('registerForm').classList.add('hidden');
        document.getElementById('loginForm').classList.remove('hidden');
      }
    }

    // Start the application
    init();

    // =================================
    // GLOBAL ERROR HANDLER
    // =================================
    
    window.addEventListener('unhandledrejection', (event) => {
      console.error('Unhandled promise rejection:', event.reason);
      showToast('An unexpected error occurred', 'error');
    });

  })();
  </script>

  <!--
    ===========================================
    DEPLOYMENT CHECKLIST
    ===========================================
    
    Before deploying to production:
    
    1. ‚úÖ Update API_CONFIG.baseURL with your actual API endpoint
    2. ‚úÖ Update API_CONFIG.wsURL with your WebSocket endpoint
    3. ‚úÖ Implement all API endpoints listed at the top of this file
    4. ‚úÖ Set up database with recommended schema
    5. ‚úÖ Configure CORS to allow your frontend domain
    6. ‚úÖ Implement rate limiting on the backend
    7. ‚úÖ Set up SSL certificates (HTTPS)
    8. ‚úÖ Configure environment variables for secrets
    9. ‚úÖ Set up logging and monitoring
    10. ‚úÖ Test authentication flow end-to-end
    11. ‚úÖ Test WebSocket connections
    12. ‚úÖ Implement backup strategy for database
    13. ‚úÖ Set up CI/CD pipeline
    14. ‚úÖ Configure CDN for static assets
    15. ‚úÖ Run security audit
    16. ‚úÖ Test on multiple devices and browsers
    17. ‚úÖ Set up error tracking (e.g., Sentry)
    18. ‚úÖ Configure email service for notifications
    19. ‚úÖ Set up analytics (optional)
    20. ‚úÖ Review and update privacy policy
    
    ZERO-HARM COMPLIANCE:
    - All AI responses must pass zero-harm validation
    - Implement content filtering for harmful requests
    - Log all actions to transparency ledger
    - Require human approval for critical operations
    - Regular ethics audits of system outputs
    
    ¬© 2025 SymbioteOne-Orchestrator
    Licensed under Hybrid License
    Created by Foster + Navi
  -->
</body>
</html>
